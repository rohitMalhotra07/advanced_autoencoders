# AUTOGENERATED! DO NOT EDIT! File to edit: ../nbs/dataset.ipynb.

# %% auto 0
__all__ = ['MyImageDataset']

# %% ../nbs/dataset.ipynb 2
import cv2
import PIL
from torch.utils.data import Dataset

# %% ../nbs/dataset.ipynb 5
class MyImageDataset(Dataset):
    def __init__(self, df, augmentations):
        self.df = df
        self.augmentations = augmentations

    def __getitem__(self, idx):
        path = self.df.iloc[idx]["file_image"]
        image = cv2.imread(path, cv2.IMREAD_COLOR)
        image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)

        if self.augmentations:
            image = self.augmentations(PIL.Image.fromarray(image))
            # image = augmented["image"]

        return image

    def __len__(self):
        return len(self.df)
